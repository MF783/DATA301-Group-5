---
title: "Crash Data Exploratory Data Analysis"
output:
  html_document:
    df_print: paged
latex_engine: lualatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#install.packages(c('dplyr','ggplot2','skimr'))

library(dplyr)
library(ggplot2)
library(skimr)

```

```{r}
crash_data = read.csv('../data/cas_data.csv')

# Use skim() function from skimr package to provide a summary of the dataset
summary <- skim(crash_data)
summary

```

#### Advisory Speed Distribution

```{r}
ggplot(crash_data, aes(x = advisorySpeed)) + 
  geom_histogram(binwidth = 5, fill = "blue", color = "black") +
  theme_minimal() +
  labs(x = "Advisory Speed", y = "Count", title = "Advisory Speed Distribution")

```

#### Crash Severity


```{r}
ggplot(crash_data, aes(x = crashSeverity)) +
  geom_bar(fill = "green", color = "black") +
  theme_minimal() +
  labs(x = "Crash Severity", y = "Count", title = "Crash Severity Counts")


```

#### Number of Fatalities per Year

```{r}
crash_data %>%
  group_by(crashYear) %>%
  summarise(Fatalities = sum(fatalCount)) %>%
  ggplot(aes(x = crashYear, y = Fatalities)) +
  geom_line(color = "red") +
  theme_minimal() +
  labs(x = "Year", y = "Number of Fatalities", title = "Number of Fatalities per Year")

```


